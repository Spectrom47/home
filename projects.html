<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Projects - MyWebsite</title>
  <style>
    /* Base Reset & Layout */
    * { box-sizing: border-box; margin: 0; padding: 0; font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; }
    body {
      display: flex;
      min-height: 100vh;
      flex-direction: column;
      color: #e6eef8;
      background: linear-gradient(120deg, rgba(15,23,42,0.88), rgba(30,58,138,0.84)),
                  url('https://images.unsplash.com/photo-1503264116251-35a269479413?auto=format&fit=crop&w=1920&q=80') no-repeat center center fixed;
      background-size: cover;
    }

    header {
      background: rgba(9,12,20,0.78);
      color: #fff;
      padding: 16px 20px;
      backdrop-filter: blur(6px);
      box-shadow: 0 6px 20px rgba(2,6,23,0.6);
    }
    .container { max-width: 1024px; margin: 0 auto; display:flex; align-items:center; justify-content:space-between; gap:12px; }
    .logo { font-weight:700; letter-spacing:0.6px; color:#fff; }
    nav ul { list-style:none; display:flex; gap:8px; align-items:center; }
    nav a { display:inline-block; padding:8px 12px; color:#c7d2fe; text-decoration:none; border-radius:8px; transition:all .15s ease; }
    nav a:hover { color:#fff; background:rgba(255,255,255,0.05); transform:translateY(-1px); }
    nav li.tab-active > a, nav a.tab-active { color:#0f1724; background:#60a5fa; box-shadow:0 6px 18px rgba(96,165,250,0.28); }

    main {
      flex:1;
      max-width: 1200px;
      margin: 36px auto;
      width: 94%;
      display: grid;
      grid-template-columns: 1fr 320px;
      gap: 20px;
      align-items: start;
    }

    .panel {
      background: rgba(255,255,255,0.08);
      border-radius: 14px;
      padding: 18px;
      backdrop-filter: blur(8px);
      box-shadow: 0 12px 30px rgba(0,0,0,0.35);
      color: #e6eef8;
    }
    .panel h1 { margin-bottom: 8px; font-size: 20px; color: #fff; }
    .panel p { color: #cfe0ff; margin-bottom: 12px; }

    .cal-header { display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:12px; }
    .cal-nav { display:flex; gap:8px; }
    .btn { padding:8px 10px; border-radius:8px; cursor:pointer; border:0; font-weight:600; background: rgba(255,255,255,0.06); color:#e6eef8; box-shadow: 0 6px 18px rgba(2,6,23,0.45); transition: all .12s ease; }
    .btn:hover { transform: translateY(-2px); background: rgba(255,255,255,0.09); }

    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 10px;
    }
    .day-name { text-align:center; font-size:12px; color:#bcd7ff; opacity:0.95; }
    .date-cell {
      background: rgba(255,255,255,0.04);
      border-radius:8px;
      padding:10px;
      min-height:92px;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      cursor:pointer;
      transition: transform .14s ease, box-shadow .14s ease, background .12s ease;
      border: 1px solid rgba(255,255,255,0.03);
    }
    .date-cell:hover { transform: translateY(-4px); box-shadow: 0 10px 30px rgba(2,6,23,0.6); background: rgba(255,255,255,0.06); }

    .date-top { display:flex; justify-content:space-between; align-items:center; gap:8px; }
    .date-num { font-weight:700; color:#fff; font-size:14px; }
    .badge { font-size:11px; padding:4px 7px; border-radius:999px; background: rgba(96,165,250,0.18); color:#cfe0ff; }

    .events-list { margin-top:8px; display:flex; flex-direction:column; gap:6px; }
    .evt { font-size:12px; padding:6px 8px; border-radius:8px; background: linear-gradient(90deg, rgba(96,165,250,0.12), rgba(59,130,246,0.1)); color:#eaf2ff; box-shadow: 0 6px 14px rgba(2,6,23,0.3); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

    .timeline {
      background: rgba(255,255,255,0.06);
      border-radius: 14px;
      padding: 14px;
      height: fit-content;
    }
    .timeline h3 { color:#fff; margin-bottom:8px; }
    .timeline .item {
      padding:10px;
      border-radius:10px;
      background: rgba(255,255,255,0.03);
      margin-bottom:8px;
      color:#dbeeff;
      font-size:13px;
      display:flex; justify-content:space-between; gap:8px; align-items:center;
    }
    .timeline .time { color:#bcd7ff; font-weight:600; font-size:12px; }

    footer { margin: 24px auto 40px; width:94%; max-width:1200px; text-align:center; color:#cfe0ff; }

    .modal-backdrop { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background: rgba(2,6,23,0.6); z-index: 1000; }
    .modal { width: 92%; max-width: 720px; background: rgba(12,16,28,0.96); border-radius: 12px; padding: 18px; color: #e6eef8; box-shadow: 0 12px 40px rgba(0,0,0,0.6); }
    .modal h2 { margin-bottom:8px; color:#fff; }
    .form-row { display:flex; gap:8px; margin-top:8px; flex-wrap:wrap; }
    .input, textarea, select { padding:10px; border-radius:8px; border:1px solid rgba(255,255,255,0.06); background: rgba(255,255,255,0.02); color:#eaf2ff; min-width: 0; }
    .input { flex:1; }
    textarea { width:100%; min-height:90px; resize:vertical; }

    .muted { color:#bcd7ff; font-size:13px; }
    .hint { color:#9fbff6; font-size:12px; margin-top:8px; }

    @media (max-width: 960px) {
      main { grid-template-columns: 1fr; margin: 20px auto; }
      .timeline { order: 2; margin-top:10px; }
    }
  </style>
</head>
<body>

  <header>
    <div class="container">
      <div class="logo">Spectroms Kingdom</div>
      <nav aria-label="Main navigation">
        <ul>
          <li><a href="index.html" class="tab">Home</a></li>
          <li><a href="projects.html" class="tab tab-active">Projects</a></li>
          <li><a href="contact.html" class="tab">Contact</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main>
    <section class="panel" id="calendarPanel">
      <div class="cal-header">
        <div>
          <h1>Project Timeline</h1>
          <p class="muted">Click a date square to view or (if admin) add events. Press <strong>Shift+Q</strong> to open admin login.</p>
        </div>
        <div class="cal-nav">
          <button class="btn" id="prevMonthBtn" title="Previous month">◀</button>
          <div style="min-width:170px; text-align:center; color:#dbeeff;" id="monthLabel">Month</div>
          <button class="btn" id="nextMonthBtn" title="Next month">▶</button>
        </div>
      </div>
      <div class="calendar" id="calendarGrid"></div>
    </section>

    <aside class="timeline panel" id="timelinePanel">
      <h3>Upcoming Events</h3>
      <div id="timelineList"></div>
      <div class="hint">Events persist online via Firebase. Admin-only edits unlock with Shift+Q.</div>
    </aside>
  </main>

  <footer>

<div id="chatBox" style="position:fixed; bottom:20px; right:20px; width:300px; max-height:400px; display:flex; flex-direction:column; background:rgba(0,0,0,0.75); border-radius:12px; overflow:hidden; font-family:Arial;">
  <div id="chatMessages" style="flex:1; padding:10px; overflow-y:auto; color:#fff; font-size:13px;"></div>
  <div style="display:flex; border-top:1px solid rgba(255,255,255,0.2);">
    <input id="chatInput" type="text" placeholder="Type a message..." style="flex:1; padding:8px; border:none; outline:none;"/>
    <button id="chatSend" style="padding:8px; background:#60a5fa; border:none; color:#fff; cursor:pointer;">Send</button>
  </div>
</div>

    
    © 2025 MyWebsite — built with slightly too much coffee and curiosity.
  </footer>

  <!-- Modals -->
  <div class="modal-backdrop" id="dayModal">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="dayModalTitle">
      <h2 id="dayModalTitle">Day</h2>
      <div id="dayEventsContainer" style="margin-top:8px;"></div>
      <hr style="margin:12px 0; border-color: rgba(255,255,255,0.04)" />
      <div id="addEventSection">
        <div style="display:flex; justify-content:space-between; gap:8px; align-items:center;">
          <div class="muted" id="formDateLabel">Add event for DATE</div>
          <div class="muted" id="adminIndicator">Not admin</div>
        </div>
        <div class="form-row" style="margin-top:8px;">
          <input class="input" id="evtTitle" placeholder="Event title" />
          <input class="input" id="evtStart" type="time" />
          <input class="input" id="evtEnd" type="time" />
        </div>
        <div style="margin-top:8px;">
          <textarea id="evtDesc" placeholder="Description (optional)"></textarea>
        </div>
        <div style="display:flex; gap:8px; margin-top:10px;">
          <button class="btn" id="saveEvtBtn">Save event</button>
          <button class="btn" id="closeDayModal">Close</button>
        </div>
        <div class="hint" style="margin-top:8px;">Only admin can save or remove events.</div>
      </div>
    </div>
  </div>

  <div class="modal-backdrop" id="adminModal">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="adminModalTitle">
      <h2 id="adminModalTitle">Admin login (hidden)</h2>
      <div style="margin-top:8px;">
        <input class="input" id="adminUser" placeholder="username" />
      </div>
      <div style="margin-top:8px;">
        <input class="input" id="adminPass" placeholder="password" type="password" />
      </div>
      <div style="display:flex; gap:8px; margin-top:12px;">
        <button class="btn" id="loginBtn">Login</button>
        <button class="btn" id="cancelLoginBtn">Cancel</button>
      </div>
      <div class="hint" style="margin-top:8px;">Unauthorized <code>Use Of Material</code>, Will Be <code>Punished</code>)</div>
    </div>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyChe0_K6bjkP_RkakgSf06o0BLGofX4stQ",
      authDomain: "spectrom-9b7ce.firebaseapp.com",
      projectId: "spectrom-9b7ce",
      storageBucket: "spectrom-9b7ce.appspot.com",
      messagingSenderId: "1022687085021",
      appId: "1:1022687085021:web:bf2caba43d913c23963634"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const eventsCol = db.collection('events');
  </script>

  <!-- Main Script -->
  <script>
    (function () {
      let isAdmin = false;
      let currentYear, currentMonth;
      const dayNames = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];

      // DOM refs
      const calendarGrid = document.getElementById('calendarGrid');
      const monthLabel = document.getElementById('monthLabel');
      const prevBtn = document.getElementById('prevMonthBtn');
      const nextBtn = document.getElementById('nextMonthBtn');
      const timelineList = document.getElementById('timelineList');

      const dayModal = document.getElementById('dayModal');
      const dayModalTitle = document.getElementById('dayModalTitle');
      const dayEventsContainer = document.getElementById('dayEventsContainer');
      const formDateLabel = document.getElementById('formDateLabel');
      const adminIndicator = document.getElementById('adminIndicator');

      const evtTitle = document.getElementById('evtTitle');
      const evtStart = document.getElementById('evtStart');
      const evtEnd = document.getElementById('evtEnd');
      const evtDesc = document.getElementById('evtDesc');
      const saveEvtBtn = document.getElementById('saveEvtBtn');
      const closeDayModal = document.getElementById('closeDayModal');

      const adminModal = document.getElementById('adminModal');
      const adminUser = document.getElementById('adminUser');
      const adminPass = document.getElementById('adminPass');
      const loginBtn = document.getElementById('loginBtn');
      const cancelLoginBtn = document.getElementById('cancelLoginBtn');

      const ADMIN_USER = 'sdk';
      const ADMIN_PASS = 'sdkinteractive2023';
      let selectedDateISO = null;

      // --- Utilities ---
      function toISO(d) { return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`; }
      function formatDayLabel(iso) { const d=new Date(iso+'T00:00:00'); return d.toLocaleDateString(undefined,{ weekday:'short', month:'short', day:'numeric' }); }
      function uid() { return Math.random().toString(36).slice(2,10); }

      async function loadEvents() {
        const snapshot = await eventsCol.get();
        return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
      }

      async function eventsForDate(dateISO) {
        const all = await loadEvents();
        return all.filter(e => e.dateISO===dateISO).sort((a,b)=>a.startHHMM.localeCompare(b.startHHMM));
      }

      async function allUpcomingEvents() {
        const todayISO = toISO(new Date());
        const all = await loadEvents();
        return all.filter(e=>e.dateISO>=todayISO).sort((a,b)=> (a.dateISO+a.startHHMM).localeCompare(b.dateISO+b.startHHMM));
      }

      // --- Render Calendar ---
      async function renderCalendar(year, month) {
        calendarGrid.innerHTML = '';
        for(let i=0;i<7;i++){ const dn=document.createElement('div'); dn.className='day-name'; dn.textContent=dayNames[i]; calendarGrid.appendChild(dn); }
        const first=new Date(year, month,1);
        const firstWeekday = first.getDay();
        const daysInMonth = new Date(year, month+1,0).getDate();

        for(let i=0;i<firstWeekday;i++){ const blank=document.createElement('div'); blank.className='date-cell'; blank.style.opacity=0.2; calendarGrid.appendChild(blank); }

        for(let d=1;d<=daysInMonth;d++){
          const date = new Date(year, month, d);
          const iso = toISO(date);
          const cell = document.createElement('div'); cell.className='date-cell'; cell.dataset.iso = iso;

          const top=document.createElement('div'); top.className='date-top';
          const num=document.createElement('div'); num.className='date-num'; num.textContent=d; top.appendChild(num);

          const evts = await eventsForDate(iso);
          if(evts.length){ const b=document.createElement('div'); b.className='badge'; b.textContent=`${evts.length} event${evts.length>1?'s':''}`; top.appendChild(b); }
          else{ const spacer=document.createElement('div'); spacer.style.minWidth='34px'; top.appendChild(spacer); }
          cell.appendChild(top);

          const list=document.createElement('div'); list.className='events-list';
          evts.forEach(e=>{ const eDiv=document.createElement('div'); eDiv.className='evt'; eDiv.textContent=e.title; list.appendChild(eDiv); });
          cell.appendChild(list);

          cell.addEventListener('click',()=>openDayModal(iso));
          calendarGrid.appendChild(cell);
        }

        monthLabel.textContent = new Date(year, month).toLocaleDateString(undefined,{month:'long', year:'numeric'});
      }

      async function renderTimeline() {
        const evts = await allUpcomingEvents();
        timelineList.innerHTML='';
        evts.forEach(e=>{
          const div=document.createElement('div'); div.className='item';
          div.innerHTML=`<div>${e.title}</div><div class="time">${e.dateISO}${e.startHHMM? ' '+e.startHHMM : ''}</div>`;
          timelineList.appendChild(div);
        });
      }

      // --- Day Modal ---
      async function openDayModal(iso) {
        selectedDateISO = iso;
        dayModalTitle.textContent = formatDayLabel(iso);
        formDateLabel.textContent = 'Add event for '+formatDayLabel(iso);
        adminIndicator.textContent = isAdmin? 'Admin':'Not admin';
        evtTitle.value=evtStart.value=evtEnd.value=evtDesc.value='';
        saveEvtBtn.dataset.editing='';

        const evts = await eventsForDate(iso);
        dayEventsContainer.innerHTML='';
        evts.forEach(e=>{
          const d=document.createElement('div'); d.className='evt';
          d.textContent=e.startHHMM? `[${e.startHHMM}] ${e.title}`: e.title;
          if(isAdmin){ d.style.cursor='pointer'; d.title='Click to delete'; d.addEventListener('click',()=>deleteEvent(e.id)); }
          dayEventsContainer.appendChild(d);
        });
        dayModal.style.display='flex';
      }

      closeDayModal.addEventListener('click',()=>{dayModal.style.display='none';});

      async function saveEvent() {
        if(!isAdmin){ alert('You must be admin'); return; }
        const title = evtTitle.value.trim();
        const start = evtStart.value;
        const end = evtEnd.value;
        if(!title || !start){ alert('Title & start required'); return; }
        if(end && end<=start){ alert('End must be after start'); return; }

        const editingId = saveEvtBtn.dataset.editing;
        const eventData = { dateISO: selectedDateISO, title, startHHMM:start, endHHMM:end||'', desc:evtDesc.value.trim(), createdAt:new Date().toISOString() };
        if(editingId) eventData.id=editingId;

        if(editingId) await eventsCol.doc(editingId).set(eventData);
        else await eventsCol.add(eventData);

        evtTitle.value=evtStart.value=evtEnd.value=evtDesc.value='';
        delete saveEvtBtn.dataset.editing;
        await renderCalendar(currentYear,currentMonth);
        await renderTimeline();
        openDayModal(selectedDateISO);
      }

      async function deleteEvent(id){
        if(!isAdmin) return alert('Only admin can delete events');
        if(!confirm('Delete this event?')) return;
        await eventsCol.doc(id).delete();
        await renderCalendar(currentYear,currentMonth);
        await renderTimeline();
        if(selectedDateISO) openDayModal(selectedDateISO);
      }

      saveEvtBtn.addEventListener('click', saveEvent);

      // --- Admin login ---
      document.addEventListener('keydown', e=>{
        if(e.shiftKey && e.key.toLowerCase()==='q'){ adminModal.style.display='flex'; }
      });
      loginBtn.addEventListener('click', ()=>{
        if(adminUser.value===ADMIN_USER && adminPass.value===ADMIN_PASS){ isAdmin=true; alert('Admin login success'); adminModal.style.display='none'; renderCalendar(currentYear,currentMonth); renderTimeline(); }
        else{ alert('Wrong credentials'); }
      });
      cancelLoginBtn.addEventListener('click',()=>adminModal.style.display='none');

      // --- Month navigation ---
      prevBtn.addEventListener('click',()=>{ const d=new Date(currentYear,currentMonth-1,1); currentYear=d.getFullYear(); currentMonth=d.getMonth(); renderCalendar(currentYear,currentMonth); });
      nextBtn.addEventListener('click',()=>{ const d=new Date(currentYear,currentMonth+1,1); currentYear=d.getFullYear(); currentMonth=d.getMonth(); renderCalendar(currentYear,currentMonth); });

      // --- Init ---
      (function init(){
        const today=new Date();
        currentYear=today.getFullYear();
        currentMonth=today.getMonth();
        renderCalendar(currentYear,currentMonth);
        renderTimeline();
      })();

      // --- Realtime updates ---
      eventsCol.onSnapshot(()=>{ renderCalendar(currentYear,currentMonth); renderTimeline(); if(selectedDateISO) openDayModal(selectedDateISO); });

    })();
  </script>
</body>
</html>
